<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="static/style.css">
    <title>Car Price Predictor</title>
  </head>
  <body class="bg-dark">
    <div class="container">
        <div class="row mt-5">
            <div class="card" style="width: 500px; margin: auto;">
                <div class="card-header bg-primary text-white">
                    <h3 class="mb-0" style="text-align: center;">Car Price Predictor</h3>
                </div>
                <div class="card-body">
                    <form action="/" method="post">
                        <div class="form-group">
                          <label><b>Select Company:</b></label>
                          <select class="form-control" id="company" name="company" required onchange="load_cars('company', 'model')">
                            <option value="">-- Select Company --</option>
                            {% for company in companies %}
                            <option value="{{ company }}">{{ company }}</option>
                            {% endfor %}
                          </select>
                        </div>

                        <div class="form-group">
                          <label><b>Select Model:</b></label>
                          <select class="form-control" id="model" name="model" required>
                            <option value="">-- Select Model --</option>
                            {% for model in car_models %}
                            <option value="{{ model }}">{{ model }}</option>
                            {% endfor %}
                          </select>
                        </div>

                        <div class="form-group">
                          <label><b>Year of Manufacture:</b></label>
                          <select class="form-control" id="year" name="year" required>
                            <option value="">-- Select Year --</option>
                            {% for year in years %}
                            <option value="{{ year }}">{{ year }}</option>
                            {% endfor %}
                          </select>
                        </div>

                        <div class="form-group">
                          <label><b>Fuel Type:</b></label>
                          <select class="form-control" id="fuel_type" name="fuel_type" required>
                            <option value="">-- Select Fuel Type --</option>
                            {% for fuel in fuel_types %}
                            <option value="{{ fuel }}">{{ fuel }}</option>
                            {% endfor %}
                          </select>
                        </div>

                        <div class="form-group">
                          <label><b>Enter Kilometers Driven:</b></label>
                          <input type="number" class="form-control" id="kilo_driven" name="kilo_driven" placeholder="Kilometers Driven" required>
                        </div>

                        <div class="form-group text-center">
                          <button type="submit" class="btn btn-primary btn-lg">Predict Price</button>
                        </div>
                    </form>

                    {% if prediction %}
                    <div class="alert alert-success mt-4">
                      <h4 style="text-align: center;">Predicted Price: â‚¹{{ prediction }}</h4>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      var companyModels = {{ company_models | safe }};

      function load_cars(company_id, car_model_id){
        var company = document.getElementById(company_id);
        var car_model = document.getElementById(car_model_id);
        
        car_model.innerHTML = "<option value=''>-- Select Model --</option>";

        if (company.value && company.value in companyModels) {
          var models = companyModels[company.value];
          for (var i = 0; i < models.length; i++) {
            var newoption = document.createElement("option");
            newoption.value = models[i];
            newoption.innerHTML = models[i];
            car_model.appendChild(newoption);
          }
        }
      }
    </script>
  </body>
</html>